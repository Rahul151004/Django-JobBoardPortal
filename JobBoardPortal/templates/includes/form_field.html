{% comment %}
Reusable form field template
Usage: {% include 'includes/form_field.html' with field=form.field_name label="Custom Label" required=True %}
{% endcomment %}

<div class="mb-3">
    <label for="{{ field.id_for_label }}" class="form-label">
        {% if label %}
            {{ label }}
        {% else %}
            {{ field.label }}
        {% endif %}
        {% if required or field.field.required %}
            <span class="text-danger">*</span>
        {% endif %}
    </label>
    
    {% if field.field.widget.input_type == 'textarea' %}
        <textarea 
            class="form-control {% if field.errors %}is-invalid{% elif field.value %}is-valid{% endif %}" 
            id="{{ field.id_for_label }}" 
            name="{{ field.name }}" 
            {% if field.field.required %}required{% endif %}
            {% if placeholder %}placeholder="{{ placeholder }}"{% endif %}
            rows="{{ rows|default:4 }}"
        >{{ field.value|default:'' }}</textarea>
    {% elif field.field.widget.input_type == 'select' %}
        <select 
            class="form-select {% if field.errors %}is-invalid{% elif field.value %}is-valid{% endif %}" 
            id="{{ field.id_for_label }}" 
            name="{{ field.name }}" 
            {% if field.field.required %}required{% endif %}
        >
            {% for choice in field.field.choices %}
                <option value="{{ choice.0 }}" {% if choice.0 == field.value %}selected{% endif %}>
                    {{ choice.1 }}
                </option>
            {% endfor %}
        </select>
    {% elif field.field.widget.input_type == 'file' %}
        <input 
            type="file" 
            class="form-control {% if field.errors %}is-invalid{% elif field.value %}is-valid{% endif %}" 
            id="{{ field.id_for_label }}" 
            name="{{ field.name }}" 
            {% if field.field.required %}required{% endif %}
            {% if accept %}accept="{{ accept }}"{% endif %}
        >
    {% else %}
        <input 
            type="{{ field.field.widget.input_type|default:'text' }}" 
            class="form-control {% if field.errors %}is-invalid{% elif field.value %}is-valid{% endif %}" 
            id="{{ field.id_for_label }}" 
            name="{{ field.name }}" 
            value="{{ field.value|default:'' }}"
            {% if field.field.required %}required{% endif %}
            {% if placeholder %}placeholder="{{ placeholder }}"{% endif %}
        >
    {% endif %}
    
    {% if field.errors %}
        <div class="invalid-feedback">
            {% for error in field.errors %}
                {{ error }}
            {% endfor %}
        </div>
    {% endif %}
    
    {% if help_text or field.help_text %}
        <div class="form-text">
            {{ help_text|default:field.help_text }}
        </div>
    {% endif %}
</div>